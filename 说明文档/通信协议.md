# 通信协议

[TOC]

## 发送给Server和SDK的信息

### 游戏开始阶段

通信内容如下

```json
{
	"walls":"[[left,right,bottom,top], ...]",		//墙的左右下上坐标，全部为整数
	"number":0/1/2/3...,//非broadcast信息，每个AI控制的人的编号
}
```

###  每一轮结束/游戏开始阶段

通信内容如下

```json
{
    "humans" : "[[num,[x,y],rotation,hp,grenade_number,fire_time],...]",	
                //编号，坐标实数，旋转角度[0~360]实数，血量，天降正义剩余量，距离下一次开火的时间整数
    "fireballs" : "[[[x,y],rotation],...]",
				//坐标实数，旋转角度[0~360]实数
    "meteors" : "[[[x,y],lasttime],...]",
                 //坐标实数，距离爆炸的帧数整数>0
    "balls" : "[[x,y],belong]",
				//坐标实数，持有者的编号，不存在则返回-1
    "events" : "[[opt,...]]"  
}
```

对于opt的解释如下：

1.  玩家开火，`[opt=1,number]`，表示当前帧number玩家发出了一个火球
2.  玩家受伤，`[opt=2,number,hurt]`，表示当前帧number玩家收到了hurt点伤害
3.  玩家死亡，`[opt=3,number]`，表示当前帧number玩家死亡，并在下一帧重生
4.  玩家发动天降正义，`[opt=4,number]`，表示当前帧number玩家发动了天降正义
5.  玩家捡到了球，`[opt=5,number]`，表示当前帧number玩家捡到了球
6.  火球爆炸，`[opt=6,x,y]`，表示当前帧[x,y]位置处爆炸
7.  天降正义，`[opt=7,x,y]`，表示在当前帧[x,y]位置处发生天降正义
8.  玩家重生，`[opt=8,number,x,y]，`表示当前帧number玩家重生在[x,y]位置
9.  火球撞墙消失，`[opt=9,x,y]`，表示当前帧在[x,y]有一个火球消失了

## 接收到SDK的信息

```json
{
    "flag": 1/2/3/4,		//分别表示向前移动/旋转/发火球/天降正义
    "args": "[x,y]/[rot,0]/[0,0]/[x,y]",		  //移动位置/旋转角度/无意义/天降正义	 		
}
```